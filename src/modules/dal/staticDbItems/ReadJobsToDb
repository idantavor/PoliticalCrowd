from Logger import getLogger
from dbconnector import *

def main() :
    graph = bolt_connect()  # type: Graph
    logger = getLogger('crawler')
    with open("jobs.txt", 'rb') as f:
        for line in f.readlines():
            if len(line) > 1:  # line not empty
                # insert the job to the db
                job_name = str(line.strip(),encoding='utf-8')
                job_cat = JobCategory.select(graph, primary_value=job_name).first()  # type: JobCategory
                if job_cat == None:
                    logger.info("adding JobCategory {} to the DB".format(job_name))
                    JobCategory.createJobCategory(graph=graph, job_name=job_name)
                else:
                    logger.info("job cat {} already exists".format(job_name))


#main()


